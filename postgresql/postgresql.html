
<!DOCTYPE html>


<html lang="en-US" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>User Guide for PostgreSQL &#8212; ADPS V3.0.44811</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css?v=84d92f63" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=6da122b0"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'postgresql/postgresql';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="User Guide for Caché" href="../cachedb/cachedb.html" />
    <link rel="prev" title="User Guide for Informix" href="../informix/informix.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en-US"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="ADPS V3.0.44811 - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="ADPS V3.0.44811 - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Deployment</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../install/install.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agent_install/agent_install.html">Agent Installation Guide</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Management</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../administrator/administrator.html">Administrator’s Guide</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Databases</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../oracle/oracle.html">User Guide for Oracle</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mysql/mysql.html">User Guide for MySQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mssql/mssql.html">User Guide for Microsoft SQL Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../db2/db2.html">User Guide for DB2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sybase/sybase.html">User Guide for Sybase</a></li>
<li class="toctree-l1"><a class="reference internal" href="../informix/informix.html">User Guide for Informix</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">User Guide for PostgreSQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cachedb/cachedb.html">User Guide for Caché</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hana/hana.html">User Guide for SAP HANA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mariadb/mariadb.html">User Guide for MariaDB</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Files</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../file/file.html">User Guide for File</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Big Data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../mongodb/mongodb.html">User Guide for MongoDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hadoop/hadoop.html">User Guide for Hadoop</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Object Storage</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../obs/obs.html">User Guide for Object Storage Service</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../exchange/exchange.html">User Guide for Microsoft Exchange Server</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Operating Systems</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../linux_os/linux_os.html">User Guide for Linux OS</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Containers</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../k8s/k8s.html">User Guide for Kubernetes</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Virtualization</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../vmware/vmware.html">User Guide for VMware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../openstack/openstack.html">User Guide for OpenStack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyper_v/hyper_v.html">User Guide for Hyper-V</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">



<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>User Guide for PostgreSQL</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#planning-and-preparation">Planning and preparation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#install-and-configure-the-agent">Install and configure the agent</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-the-compatibility">Verify the compatibility</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#install-the-agent">Install the agent</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#windows">Windows</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#linux">Linux</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#activate-licenses-and-authorize-users">Activate licenses and authorize users</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#backup">Backup</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#backup-types">Backup types</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#backup-policies">Backup policies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#before-you-begin">Before you begin</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#log-in-to-the-resource">Log in to the resource</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-backup-job">Create a backup job</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#backup-options">Backup options</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#restore">Restore</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#restore-types">Restore types</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Before you begin</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-point-in-time-restore-job">Create a point-in-time restore job</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-logical-recovery-job">Create a logical recovery job</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-log-restore-job">Create a log restore job</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-recovery-testing-job">Create a recovery testing job</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#restore-options">Restore options</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cluster-backup-and-restore">Cluster backup and restore</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Before you begin</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bind-nodes-into-a-cluster">Bind nodes into a cluster</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#backup-and-restore">Backup and restore</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#limitations">Limitations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#glossary">Glossary</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="user-guide-for-postgresql">
<h1>User Guide for PostgreSQL<a class="headerlink" href="#user-guide-for-postgresql" title="Link to this heading">#</a></h1>
<p>This guide introduces how to install and configure the ADPS agent, and how to properly use ADPS to back up and restore PostgreSQL.</p>
<p>The backup and restore features supported by ADPS include:</p>
<ul>
<li><p>Backup sources</p>
<p>Database, schema, and table</p>
</li>
<li><p>Backup types</p>
<p>Full backup, incremental backup, log backup, and logical backup</p>
</li>
<li><p>Backup targets</p>
<p>Standard storage pool, deduplication storage pool, local storage pool, tape library pool, object storage service pool, and LAN-free pool</p>
</li>
<li><p>Backup schedules</p>
<p>Immediate, one-time, hourly, daily, weekly, and monthly.</p>
</li>
<li><p>Data processing</p>
<p>Data compression, data encryption, multiple channels, reconnection, speed limit, and replication</p>
</li>
<li><p>Restore types</p>
<p>Point-in-time restore, logical recovery, log restore, and recovery testing</p>
</li>
<li><p>Restore targets</p>
<p>Original host and different host (ADPS supports cross-machine restore of PostgreSQL with varying minor versions.)</p>
</li>
<li><p>Restore options</p>
<p>Channels, restore database (origin or new), open database after restore, archive log destination, database configuration file</p>
</li>
</ul>
<section id="planning-and-preparation">
<h2>Planning and preparation<a class="headerlink" href="#planning-and-preparation" title="Link to this heading">#</a></h2>
<p>Before you install the agent, check the following prerequisites:</p>
<ol class="arabic simple">
<li><p>You have already installed and configured other backup components, including the backup server and the storage server.</p></li>
<li><p>You have created a user with roles of operator and administrator on the ADPS console. Log in to the console with this user to back up and restore the resource.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The administrator role can install and configure agents, activate licenses, and authorize users. The operator role can create backup/restore jobs and conduct copy data management (CDM).</p>
</div>
</section>
<section id="install-and-configure-the-agent">
<h2>Install and configure the agent<a class="headerlink" href="#install-and-configure-the-agent" title="Link to this heading">#</a></h2>
<p>To back up and restore PostgreSQL, first install the ADPS agent on the host where PostgreSQL resides.</p>
<section id="verify-the-compatibility">
<h3>Verify the compatibility<a class="headerlink" href="#verify-the-compatibility" title="Link to this heading">#</a></h3>
<p>Before you install the agent, ensure that the environment of the host where PostgreSQL resides is on the Aurreum Data Protection Suite’s compatibility lists.</p>
<p>ADPS supports the backup and restore of PostgreSQL, including standalone single instance, standalone multiple instances, and Master-Slave replication. Supported versions include:</p>
<ul class="simple">
<li><p>PostgreSQL 8.1/8.4</p></li>
<li><p>PostgreSQL 9.1/9.2/9.3/9.4/9.5/9.6</p></li>
<li><p>PostgreSQL 10.6/10.8/10.19</p></li>
<li><p>PostgreSQL 11.0/11.1/11.7</p></li>
<li><p>PostgreSQL 12.1/12.2/12.3/12.9</p></li>
<li><p>PostgreSQL 13.0/13.4/13.5/13.8</p></li>
<li><p>PostgreSQL 14.0/14.1/14.2/14.3/14.4/14.5/14.6</p></li>
<li><p>PostgreSQL 15.0/15.1</p></li>
</ul>
</section>
<section id="install-the-agent">
<h3>Install the agent<a class="headerlink" href="#install-the-agent" title="Link to this heading">#</a></h3>
<p>The ADPS agent can be installed on Windows and Linux. You can select the installation method according to your environment.</p>
<section id="windows">
<h4>Windows<a class="headerlink" href="#windows" title="Link to this heading">#</a></h4>
<p>To install the agent, do the following:</p>
<ol class="arabic">
<li><p>Log in to the ADPS console.</p></li>
<li><p>From the menu, click <strong>Resource</strong> &gt; <strong>Resource</strong>. The <strong>Resource</strong> page appears.</p></li>
<li><p>From the toolbar, click the <strong>Install agent</strong> icon. The <strong>Install agent</strong> window appears.</p></li>
<li><p>In the <strong>Install agent</strong> window, do the following:</p>
<p>(1) From the <strong>Select system</strong> list, select <strong>Windows</strong>.</p>
<p>(2) From the <strong>Select file</strong> list, select the package that you want to install.</p>
<p>(3) Click <strong>Download</strong>.</p>
</li>
<li><p>Upload the package to the Windows host.</p></li>
<li><p>Log in to the Windows host as a user with administrative privileges. Double-click the package and open the installation wizard. Click <strong>Next</strong>.</p></li>
<li><p>At the <strong>Select components</strong> step, select <strong>PostgreSQL</strong> from the component list. Click <strong>Next</strong>.</p></li>
<li><p>At the <strong>Configure Aurreum Data Protection Suite agent</strong> step, enter the following:</p>
<p>(1) In the <strong>Backup server address</strong> field, enter the IP or domain name of the backup server.</p>
<p>(2) In the <strong>Backup server port</strong> field, enter the port number. The default value is 50305. If you enable the <strong>Use SSL secure connection</strong> option, enter 60305 in the <strong>Backup server port</strong> field.</p>
<p>(3) The <strong>Access key</strong> field is optional and blank by default. If your backup server adopts multi-tenancy, you must enter the access key of the tenant for the agent.</p>
<p>(4) Click <strong>Next</strong>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To get the access key of the user/tenant:</p>
<ol class="arabic simple">
<li><p>Log in to the ADPS console.</p></li>
<li><p>On the upper right corner, click your avatar, and go to <strong>Personal settings</strong> &gt; <strong>Account settings</strong>.</p></li>
<li><p>On the <strong>Preference</strong> tab, click <strong>View</strong> to get the access key of the current user/tenant.</p></li>
</ol>
</div>
</li>
<li><p>Confirm the <strong>Destination folder</strong> or specify another folder. Click <strong>Next</strong>.</p></li>
<li><p>Wait for the installation to complete.</p></li>
</ol>
</section>
<section id="linux">
<h4>Linux<a class="headerlink" href="#linux" title="Link to this heading">#</a></h4>
<p>For Linux OS, ADPS agent supports online and offline installation. We recommend online installation.</p>
<ol class="arabic simple">
<li><p>Online installation:
ADPS provides <code class="docutils literal notranslate"><span class="pre">curl</span></code> and <code class="docutils literal notranslate"><span class="pre">wget</span></code> commands for installation.</p></li>
<li><p>Offline installation:
See <a class="reference internal" href="../agent_install/agent_install.html#offline-installation"><span class="std std-ref">Offline installation</span></a> in Aurreum Data Protection Suite Agent Installation Guide.</p></li>
</ol>
<p>To install the agent online, do the following:</p>
<ol class="arabic">
<li><p>Log in to the ADPS console.</p></li>
<li><p>From the menu, click <strong>Resource</strong> &gt; <strong>Resource</strong>. The <strong>Resource</strong> page appears.</p></li>
<li><p>From the toolbar, click the <strong>Install agent</strong> icon. The <strong>Install agent</strong> window appears.</p></li>
<li><p>In the <strong>Install agent</strong> window, do the following:</p>
<p>(1) From the <strong>Select system</strong> list, select <strong>Linux</strong>.</p>
<p>(2) From the <strong>Component</strong> list, select <strong>PostgreSQL</strong>. The <code class="docutils literal notranslate"><span class="pre">curl</span></code> and <code class="docutils literal notranslate"><span class="pre">wget</span></code> commands appear in the window.</p>
<p>(3) If you want to delete the downloaded package automatically after the installation, select the <strong>Delete installation package</strong> checkbox.</p>
<p>(4) If you enable <strong>Ignore SSL errors</strong>, the installation will ignore certificate errors and so on. If you disable the feature, the installation will prompt you to enter Y/N to continue or discontinue the process when an error occurs.</p>
</li>
<li><p>Click the <strong>Copy</strong> icon to copy the <code class="docutils literal notranslate"><span class="pre">curl</span></code> or <code class="docutils literal notranslate"><span class="pre">wget</span></code> command.</p></li>
<li><p>Log in to the Linux host as user <em>root</em>. Paste the command in the terminal and press Enter to start the installation. Example:</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@ubuntu</span><span class="p">:</span><span class="o">~</span><span class="c1"># curl -o- &quot;http://192.168.20.192:50305/d2/update/script?modules=postgres&amp;location=http%3A%2F%2F192.168.20.192%3A50305&amp;access_key=acaa24b49fbf2655de1a5dae72a4b56e&amp;rm=&amp;tool=curl&quot; | sh</span>
	<span class="o">%</span> <span class="n">Total</span>    <span class="o">%</span> <span class="n">Received</span> <span class="o">%</span> <span class="n">Xferd</span>  <span class="n">Average</span> <span class="n">Speed</span>   <span class="n">Time</span>    <span class="n">Time</span>     <span class="n">Time</span>  <span class="n">Current</span>
                                 <span class="n">Dload</span>  <span class="n">Upload</span>   <span class="n">Total</span>   <span class="n">Spent</span>    <span class="n">Left</span>  <span class="n">Speed</span>
	<span class="mi">100</span>  <span class="mi">9210</span>    <span class="mi">0</span>  <span class="mi">9210</span>    <span class="mi">0</span>     <span class="mi">0</span>  <span class="mi">1697</span><span class="n">k</span>      <span class="mi">0</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="mi">2998</span><span class="n">k</span>
    <span class="o">%</span> <span class="n">Total</span>    <span class="o">%</span> <span class="n">Received</span> <span class="o">%</span> <span class="n">Xferd</span>  <span class="n">Average</span> <span class="n">Speed</span>   <span class="n">Time</span>    <span class="n">Time</span>     <span class="n">Time</span>  <span class="n">Current</span>
                                 <span class="n">Dload</span>  <span class="n">Upload</span>   <span class="n">Total</span>   <span class="n">Spent</span>    <span class="n">Left</span>  <span class="n">Speed</span>
    <span class="mi">0</span>     <span class="mi">0</span>    <span class="mi">0</span>     <span class="mi">0</span>    <span class="mi">0</span>     <span class="mi">0</span>      <span class="mi">0</span>      <span class="mi">0</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span>     <span class="mi">0</span>
    <span class="mi">100</span> <span class="mf">68.7</span><span class="n">M</span>  <span class="mi">100</span> <span class="mf">68.7</span><span class="n">M</span>    <span class="mi">0</span>     <span class="mi">0</span>  <span class="mf">80.7</span><span class="n">M</span>      <span class="mi">0</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="mf">71.7</span><span class="n">M</span>
    <span class="o">%</span> <span class="n">Total</span>    <span class="o">%</span> <span class="n">Received</span> <span class="o">%</span> <span class="n">Xferd</span>  <span class="n">Average</span> <span class="n">Speed</span>   <span class="n">Time</span>    <span class="n">Time</span>     <span class="n">Time</span>  <span class="n">Current</span>
                                 <span class="n">Dload</span>  <span class="n">Upload</span>   <span class="n">Total</span>   <span class="n">Spent</span>    <span class="n">Left</span>  <span class="n">Speed</span>
    <span class="mi">0</span>     <span class="mi">0</span>    <span class="mi">0</span>     <span class="mi">0</span>    <span class="mi">0</span>     <span class="mi">0</span>      <span class="mi">0</span>      <span class="mi">0</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span>     <span class="mi">0</span>
    <span class="mi">100</span> <span class="mi">7890</span><span class="n">k</span>  <span class="mi">100</span> <span class="mi">7890</span><span class="n">k</span>    <span class="mi">0</span>     <span class="mi">0</span>  <span class="mf">60.2</span><span class="n">M</span>      <span class="mi">0</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="mf">60.2</span><span class="n">M</span>
    <span class="o">%</span> <span class="n">Total</span>    <span class="o">%</span> <span class="n">Received</span> <span class="o">%</span> <span class="n">Xferd</span>  <span class="n">Average</span> <span class="n">Speed</span>   <span class="n">Time</span>    <span class="n">Time</span>     <span class="n">Time</span>  <span class="n">Current</span>
                                 <span class="n">Dload</span>  <span class="n">Upload</span>   <span class="n">Total</span>   <span class="n">Spent</span>    <span class="n">Left</span>  <span class="n">Speed</span>
    <span class="mi">0</span>     <span class="mi">0</span>    <span class="mi">0</span>     <span class="mi">0</span>    <span class="mi">0</span>     <span class="mi">0</span>      <span class="mi">0</span>      <span class="mi">0</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span>     <span class="mi">0</span>
    <span class="mi">100</span> <span class="mi">5913</span><span class="n">k</span>  <span class="mi">100</span> <span class="mi">5913</span><span class="n">k</span>    <span class="mi">0</span>     <span class="mi">0</span>  <span class="mf">60.2</span><span class="n">M</span>      <span class="mi">0</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="mf">60.2</span><span class="n">M</span>
</pre></div>
</div>
<ol class="arabic simple" start="7">
<li><p>Wait for the installation to complete.</p></li>
</ol>
</section>
</section>
</section>
<section id="activate-licenses-and-authorize-users">
<h2>Activate licenses and authorize users<a class="headerlink" href="#activate-licenses-and-authorize-users" title="Link to this heading">#</a></h2>
<p>After the agent installation, go back to the <strong>Resource</strong> page. The host with the agent installed appears on the page. Before you back up and restore PostgreSQL, register the host, activate the backup license, and authorize users.</p>
<p>To activate licenses and authorize users, do the following:</p>
<ol class="arabic simple">
<li><p>From the menu, click <strong>Resource</strong> &gt; <strong>Resource</strong>. The <strong>Resource</strong> page appears.</p></li>
<li><p>On the <strong>Resource</strong> page, select the host where PostgreSQL resides. Click the <strong>Register</strong> icon. After the registration, the <strong>Activate</strong> window appears.</p></li>
</ol>
<ol class="arabic" start="3">
<li><p>In the <strong>Activate</strong> window, select the PostgreSQL backup license, and click <strong>Submit</strong>. After the activation, the <strong>Authorize</strong> window appears.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are prompted with “No enough licenses”, contact the administrator to add licenses.</p>
</div>
</li>
<li><p>In the <strong>Authorize</strong> window, select user groups to authorize access to the resource. Click <strong>Submit</strong>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>With many agents, install them first, then <strong>batch register</strong>, <strong>batch activate</strong>, and <strong>batch authorize</strong> the agents and resources for convenience. For details, see <a class="reference internal" href="#../manager/manager.md#batch-registerbatch-activatebatch-authorize"><span class="xref myst">Batch register/Batch activate/Batch authorize</span></a> in Aurreum Data Protection Suite Administrator’s Guide.</p>
</div>
</li>
</ol>
</section>
<section id="backup">
<h2>Backup<a class="headerlink" href="#backup" title="Link to this heading">#</a></h2>
<section id="backup-types">
<h3>Backup types<a class="headerlink" href="#backup-types" title="Link to this heading">#</a></h3>
<p>ADPS provides four common backup types for PostgreSQL.</p>
<ul>
<li><p>Full backup</p>
<p>Backs up all the databases on the instance.</p>
</li>
<li><p>Incremental backup</p>
<p>Backs up data blocks that have changed since the last backup, with a full backup as the baseline. If the database has not been fully backed up, or has not been fully backed up after the restore, the first incremental backup will be performed as a full backup by default.</p>
</li>
<li><p>Log backup</p>
<p>Backs up the archive logs of database instances, with a full backup as the baseline.</p>
</li>
<li><p>Logical backup</p>
<p>Backs up one or more databases, schemas, and tables. Currently, you can select only one of the following types for a logical backup job: database, schema, and table.</p>
</li>
</ul>
</section>
<section id="backup-policies">
<h3>Backup policies<a class="headerlink" href="#backup-policies" title="Link to this heading">#</a></h3>
<p>ADPS provides six backup schedule types: immediate, one-time, hourly, daily, weekly, and monthly.</p>
<ul class="simple">
<li><p>Immediate: ADPS will immediately start the job after it is created.</p></li>
<li><p>One-time: ADPS will perform the job at the specified time once only.</p></li>
<li><p>Hourly: ADPS will perform the job periodically at the specified hour/minute intervals within the time range according to the setting.</p></li>
<li><p>Daily: ADPS will perform the job periodically at the specified time and day intervals.</p></li>
<li><p>Weekly: ADPS will perform the job periodically at the specified time and week intervals.</p></li>
<li><p>Monthly: ADPS will perform the job periodically at the specified dates and times.</p></li>
</ul>
<p>You can set an appropriate backup policy based on your situation and requirements. Usually, we recommend the following common backup policy:</p>
<ol class="arabic simple">
<li><p>Perform a <strong>full backup</strong> once a week when the application traffic is relatively small (Example: on the weekend) to ensure that you have a recoverable point in time every week.</p></li>
<li><p>Perform an <strong>incremental backup</strong> every day when the application traffic is relatively small (Example: at 2 a.m.) to ensure that you have a recoverable point in time every day, which can save storage space and backup time.</p></li>
<li><p>Perform a <strong>log backup</strong> hourly if your database supports log backups to achieve the precise point-in-time restore and ensure that the restore granularity can reach the second level.</p></li>
</ol>
<p>Avoid using the following strategies: Only perform full backups or perform a full backup followed by all incremental or log backups.</p>
</section>
<section id="before-you-begin">
<h3>Before you begin<a class="headerlink" href="#before-you-begin" title="Link to this heading">#</a></h3>
<p>Before you back up and restore PostgreSQL, check the following:</p>
<ol class="arabic simple">
<li><p>Check the PostgreSQL instance status</p></li>
</ol>
<ul>
<li><p>Windows</p>
<p>Log in to the host and open the service list. Check whether the PostgreSQL service status is <em>Running</em> or not.</p>
</li>
<li><p>Linux</p>
<p>The PostgreSQL database service should be in the “Running” state for backup and restore.</p>
</li>
</ul>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>-bash-4.2$<span class="w"> </span>/usr/pgsql-13/bin/pg_ctl<span class="w"> </span>-D<span class="w"> </span>/var/lib/pgsql/13/data/<span class="w"> </span>-l<span class="w"> </span>logfile<span class="w"> </span>status
<span class="w"> </span>pg_ctl:<span class="w"> </span>server<span class="w"> </span>is<span class="w"> </span>running<span class="w"> </span><span class="o">(</span>PID:<span class="w"> </span><span class="m">18378</span><span class="o">)</span>
<span class="w"> </span>/usr/pgsql-13/bin/postgres<span class="w"> </span><span class="s2">&quot;-D&quot;</span><span class="w"> </span><span class="s2">&quot;/var/lib/pgsql/13/data/&quot;</span>
</pre></div>
</div>
<ol class="arabic" start="2">
<li><p>Check storage pools.</p>
<p>(1) From the menu, click <strong>Storage</strong> &gt; <strong>Storage pool</strong>. The <strong>Storage pool</strong> page appears.</p>
<p>(2) Check whether the display area has any storage pools. If no, create a storage pool and authorize it for the current user. For details, see <a class="reference internal" href="#../manager/manager.md#add-a-storage-pool"><span class="xref myst">Add a storage pool</span></a> in Aurreum Data Protection Suite Administrator’s Guide.</p>
</li>
<li><p>Check the minimum privileges required for a database user to do backups.</p></li>
</ol>
<table class="longtable table" id="id3">
<caption><span class="caption-text">Minimum privileges required</span><a class="headerlink" href="#id3" title="Link to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Backup types</p></th>
<th class="head"><p>Minimum privileges required</p></th>
<th class="head"><p>Database versions required</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Physical backup</p></td>
<td><p>grant execute on function pg_start_backup(text,boolean,boolean) to &lt;user_name&gt;; <br> grant execute on function pg_stop_backup() to &lt;user_name&gt;; <br> grant pg_read_all_settings to &lt;user_name&gt;;</p></td>
<td><p>PostgreSQL 10.0 and later</p></td>
</tr>
<tr class="row-odd"><td><p>Physical backup</p></td>
<td><p>alter user &lt;user_name&gt; with superuser;</p></td>
<td><p>Versions prior to PostgreSQL 10.0</p></td>
</tr>
<tr class="row-even"><td><p>Log backup</p></td>
<td><p>grant execute on function pg_switch_wal() to &lt;user_name&gt;;</p></td>
<td><p>PostgreSQL 10.0 and later</p></td>
</tr>
<tr class="row-odd"><td><p>Log backup</p></td>
<td><p>grant execute on function pg_switch_xlog() to &lt;user_name&gt;;</p></td>
<td><p>Versions prior to PostgreSQL 10.0</p></td>
</tr>
<tr class="row-even"><td><p>Logical backup</p></td>
<td><p>grant connect on database &lt;database_name&gt; to &lt;user_name&gt;; <br> grant usage on schema &lt;schema_name&gt; to &lt;user_name&gt;;  <br> grant select on all tables in schema &lt;schema_name&gt; to &lt;user_name&gt;; <br> grant select on all sequences in schema &lt;schema_name&gt; to &lt;user_name&gt;;</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</section>
<section id="log-in-to-the-resource">
<h3>Log in to the resource<a class="headerlink" href="#log-in-to-the-resource" title="Link to this heading">#</a></h3>
<p>Before you create a backup or restore job, log in to the PostgreSQL on the console.</p>
<p>To log in to the resource, do the following:</p>
<ol class="arabic simple">
<li><p>From the menu, click <strong>Resource</strong> &gt; <strong>Resource</strong>. The <strong>Resource</strong> page appears.</p></li>
<li><p>From the host list, find the host where PostgreSQL resides. If you have many hosts, use the search bar to find the host quickly. Click the host to expand its resource list.</p></li>
<li><p>Click <strong>Login</strong> beside the resource. The <strong>Login</strong> window appears.</p>
</li>
<li><p>In the <strong>Login</strong> window, enter the <strong>Username</strong> and <strong>Password</strong>, and click <strong>Login</strong>.</p></li>
<li><p>If your information is correct, you will be prompted that you have logged in to the resource successfully.</p></li>
</ol>
</section>
</section>
<section id="create-a-backup-job">
<h2>Create a backup job<a class="headerlink" href="#create-a-backup-job" title="Link to this heading">#</a></h2>
<p>To create a backup job, do the following:</p>
<ol class="arabic">
<li><p>From the menu, click <strong>Backup</strong>. The backup job wizard appears.</p></li>
<li><p>At the <strong>Hosts and resources</strong> step, select the host where PostgreSQL resides and select the instance. The wizard goes to the next step automatically.</p></li>
<li><p>At the <strong>Backup source</strong> step, do the following:</p>
<p>(1) From the <strong>Backup type</strong> list, select a backup type.</p>
<p>(2) In the <strong>Backup source</strong> section, select the databases that you want to back up.</p>
</li>
<li><p>At the <strong>Backup target</strong> step, select a storage pool. Click <strong>Next</strong>.</p></li>
<li><p>At the <strong>Backup schedule</strong> step, set the job schedule. For details, see <a class="reference internal" href="#backup-policies">Backup policies</a>. Click <strong>Next</strong>.</p>
<ul class="simple">
<li><p>Select <strong>Immediate</strong>. ADPS performs the job immediately after it is created.</p></li>
<li><p>Select <strong>One time</strong> and set the start time for the job.</p></li>
<li><p>Select <strong>Hourly</strong>. Set the start time, end time, and time interval for job execution. The unit can be hour(s) or minute(s).</p></li>
<li><p>Select <strong>Daily</strong>. Set the start time and enter the time interval for job execution. The unit is day(s).</p></li>
<li><p>Select <strong>Weekly</strong>. Set the start time, enter the time interval, and select the specific dates in a week for job execution. The unit is week.</p></li>
<li><p>Select <strong>Monthly</strong>. Set the start time and months for job execution. You can select the natural dates in one month or select the specific dates in one week.</p></li>
</ul>
</li>
<li><p>At the <strong>Backup options</strong> step, set the common and advanced options according to your needs. For details, see <a class="reference internal" href="#backup-options">Backup options</a>. Click <strong>Next</strong>.</p></li>
<li><p>At the <strong>Finish</strong> step, set the job name and confirm the job information. Click <strong>Submit</strong>.</p></li>
<li><p>After the submission, you will be redirected to the <strong>Job</strong> page automatically. On this page, you can start, modify, and delete the job.</p></li>
</ol>
<section id="backup-options">
<h3>Backup options<a class="headerlink" href="#backup-options" title="Link to this heading">#</a></h3>
<p>ADPS provides the following backup options for PostgreSQL:</p>
<ul class="simple">
<li><p>Common options</p></li>
</ul>
<table class="longtable table" id="id4">
<caption><span class="caption-text">Backup common options</span><a class="headerlink" href="#id4" title="Link to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Limitations</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Compression</p></td>
<td><p>Fast is enabled by default. <br> - None: No compression during the backup job. <br> - Tunable: Customizes the compression level. The Advanced Compression license is required.  <br> - Fast: Use the fast compression algorithms to compress data during the backup job.</p></td>
<td><p>Not available for synthetic backup jobs.</p></td>
</tr>
<tr class="row-odd"><td><p>Channels</p></td>
<td><p>It can improve backup efficiency. The default value is 1 and the value ranges from 1 to 64. <br> We recommend a value the same as the number of CPU cores. If the value exceeds the core number, the efficiency improvement will not be obvious. <br> The value for synthetic backup jobs ranges from 1 to 255.</p></td>
<td><p>Only available for full backup jobs.</p></td>
</tr>
<tr class="row-even"><td><p>Archive log directory</p></td>
<td><p>Set the archive log directory that the PostgreSQL login user has permission to operate on. The archive directory for the PostgreSQL cluster needs to be manually enabled.</p></td>
<td><p>Not available for logical backup jobs.</p></td>
</tr>
<tr class="row-odd"><td><p>Delete archive logs</p></td>
<td><p> provides the following options to delete archive logs that are backed up.  <br> - Delete all backed-up archive logs.  <br> - Delete archive logs older than 7 day(s)/hour(s).  <br> - Do not delete archive logs.</p></td>
<td><p>Not available for logical backup jobs.</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>Advanced options</p></li>
</ul>
<table class="longtable table" id="id5">
<caption><span class="caption-text">Backup advanced options</span><a class="headerlink" href="#id5" title="Link to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Limitations</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Reconnection time</p></td>
<td><p>The value ranges from 1 to 60 minutes. The job continues after the abnormal reset occurs in the network within the set time.</p></td>
<td><p>Not available for synthetic backup jobs.</p></td>
</tr>
<tr class="row-odd"><td><p>Resumption buffer size</p></td>
<td><p>Specifies the resumption buffer size. The default value is 10 MiB. The bigger the resumption buffer size is, the more physical storage will be consumed. However, a bigger resumption buffer size can prevent data loss when the throughput of the business system is high.</p></td>
<td><p>Not available for synthetic backup jobs.</p></td>
</tr>
<tr class="row-even"><td><p>Speed limit</p></td>
<td><p>Limits data transfer speed or disk read/write speed for different time periods. The unit can be KiB/s, MiB/s, and GiB/s.</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>Precondition</p></td>
<td><p>Checked before the job starts. The job execution will be aborted and the job state will be idle when the precondition is invalid.</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>Pre-/Post-script</p></td>
<td><p>The pre-script is executed after the job starts and before the resource is backed up. The post-script is executed after the resource is backed up.</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="restore">
<h2>Restore<a class="headerlink" href="#restore" title="Link to this heading">#</a></h2>
<section id="restore-types">
<h3>Restore types<a class="headerlink" href="#restore-types" title="Link to this heading">#</a></h3>
<p>For different needs, ADPS provides several restore types for PostgreSQL, including:</p>
<ul>
<li><p>Point-in-time restore</p>
<p>When a logical error or disaster occurs in a PostgreSQL database, you can perform a point-in-time restore job to restore the database to a specified point-in-time state. You can restore to the original or a different host.</p>
</li>
<li><p>Logical recovery</p>
<p>When a database, schema, or table in PostgreSQL loses data, such as files damaged or deleted by mistake, you can restore them to the latest state through Logical Recovery.</p>
</li>
<li><p>Log restore</p>
<p>A log restore job can only be executed when a log backup set exists. It only downloads archive logs to the specified directory on the target host, and does not perform the restore operation.</p>
</li>
<li><p>Recovery testing</p>
<p>Restores the latest backup sets to another instance on the original host or to another host hourly, daily, weekly, and monthly.</p>
</li>
</ul>
</section>
<section id="id1">
<h3>Before you begin<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>To restore PostgreSQL to a different host, install the agent on that host, activate the licenses, and authorize user access to the resource.</p>
</section>
<section id="create-a-point-in-time-restore-job">
<h3>Create a point-in-time restore job<a class="headerlink" href="#create-a-point-in-time-restore-job" title="Link to this heading">#</a></h3>
<p>To create a point-in-time restore job, do the following:</p>
<ol class="arabic">
<li><p>From the menu, click <strong>Restore</strong>. The restore job wizard appears.</p></li>
<li><p>At the <strong>Hosts and resources</strong> step, select the host where PostgreSQL resides and select the instance. The wizard goes to the next step automatically.</p></li>
<li><p>At the <strong>Backup sets</strong> step, do the following:</p>
<p>(1) From the <strong>Restore type</strong> list, select <strong>Point-in-time restore</strong>.</p>
<p>(2) In the <strong>Restore point in time</strong> section, specify a point in time for the restore job.</p>
<ul class="simple">
<li><p>Select <strong>Restore to point in time</strong>. If you have performed a log backup job, you can specify the restore point in time by entering the date and time or dragging the slider control.</p></li>
<li><p>Select <strong>Restore to backup state (shortest recovery time)</strong>. You can select a backup set in the <strong>Backup sets</strong> section to restore to its latest backup state.</p></li>
</ul>
<p>(3) Click <strong>Next</strong>.</p>
</li>
<li><p>At the <strong>Restore target</strong> step, select a restore target. The wizard automatically goes to the next step.</p></li>
<li><p>At the <strong>Restore schedule</strong> step, set the job schedule. Click <strong>Next</strong>.</p>
<ul class="simple">
<li><p>Select <strong>Immediate</strong>. ADPS will perform the job immediately after its creation.</p></li>
<li><p>Select <strong>One time</strong> and set the start time for the job.</p></li>
</ul>
</li>
<li><p>At the <strong>Restore options</strong> step, set the options according to your needs. See <a class="reference internal" href="#restore-options">Restore options</a>. Click <strong>Next</strong>.</p></li>
<li><p>At the <strong>Finish</strong> step, set the job name and confirm the job information. Click <strong>Submit</strong>.</p></li>
<li><p>After submission, you will be redirected to the <strong>Job</strong> page. You can start, modify, and delete the job.</p></li>
</ol>
</section>
<section id="create-a-logical-recovery-job">
<h3>Create a logical recovery job<a class="headerlink" href="#create-a-logical-recovery-job" title="Link to this heading">#</a></h3>
<p>To create an instant recovery job, do the following:</p>
<ol class="arabic">
<li><p>From the menu, click <strong>Restore</strong>. The restore job wizard appears.</p></li>
<li><p>At the <strong>Hosts and resources</strong> step, select the host where PostgreSQL resides and select the instance. The wizard goes to the next step automatically.</p></li>
<li><p>At the <strong>Backup sets</strong> step, do the following:</p>
<p>(1) From the <strong>Restore type</strong> list, select <strong>Instant recovery</strong>.</p>
<p>(2) From the <strong>Recovery type</strong> list, select a data recovery type for the restore job.</p>
<p>(3) In the <strong>Restore source</strong> section, select a database and a point in time.</p>
<p>(4) Click <strong>Next</strong>.</p>
</li>
<li><p>At the <strong>Restore target</strong> step, select a restore target. The wizard automatically goes to the next step.</p></li>
<li><p>At the <strong>Restore schedule</strong> step, set the job schedule. Click <strong>Next</strong>.</p>
<ul class="simple">
<li><p>Select <strong>Immediate</strong>. ADPS will perform the job immediately after its creation.</p></li>
<li><p>Select <strong>One time</strong> and set the start time for the job.</p></li>
</ul>
</li>
<li><p>At the <strong>Restore options</strong> step, set the options according to your needs. See <a class="reference internal" href="#restore-options">Restore options</a>. Click <strong>Next</strong>.</p></li>
<li><p>At the <strong>Finish</strong> step, set the job name and confirm the job information. Click <strong>Submit</strong>.</p></li>
<li><p>After the instant recovery, go to the <strong>CDM</strong> page. A mounted copy is added below the full copy. See <a class="reference internal" href="#view-a-copy"><span class="xref myst">View a copy</span></a>.</p></li>
</ol>
</section>
<section id="create-a-log-restore-job">
<h3>Create a log restore job<a class="headerlink" href="#create-a-log-restore-job" title="Link to this heading">#</a></h3>
<p>To create a log restore job, do the following:</p>
<ol class="arabic">
<li><p>From the menu, click <strong>Restore</strong>. The restore job wizard appears.</p></li>
<li><p>At the <strong>Hosts and resources</strong> step, select the host where PostgreSQL resides and select the instance. The wizard goes to the next step automatically.</p></li>
<li><p>At the <strong>Backup sets</strong> step, do the following:</p>
<p>(1) From the <strong>Restore type</strong> list, select <strong>Log restore</strong>.</p>
<p>(2) In the <strong>Time range</strong> section, click the time next to the option and a window pops up. In the pop-up window, select a time range. You can also drag the slider control or enter the time to specify a time range for the restore job.</p>
<p>(3) Click <strong>Next</strong>.</p>
</li>
<li><p>At the <strong>Restore target</strong> step, select a restore target. The wizard automatically goes to the next step. The target can be a standalone PostgreSQL or a cluster. When the restore target is a cluster, the restore job will be run on all the nodes in the cluster.</p></li>
<li><p>At the <strong>Restore schedule</strong> step, set the job schedule. Click <strong>Next</strong>.</p>
<ul class="simple">
<li><p>Select <strong>Immediate</strong>. ADPS will perform the job immediately after its creation.</p></li>
<li><p>Select <strong>One time</strong> and set the start time for the job.</p></li>
</ul>
</li>
<li><p>At the <strong>Restore options</strong> step, set the options according to your needs. See <a class="reference internal" href="#restore-options">Restore options</a>. Click <strong>Next</strong>.</p></li>
<li><p>At the <strong>Finish</strong> step, set the job name and confirm the job information. Click <strong>Submit</strong>.</p></li>
<li><p>After the submission, you will be redirected to the <strong>Job</strong> page. You can start, modify, and delete the job.</p></li>
</ol>
</section>
<section id="create-a-recovery-testing-job">
<h3>Create a recovery testing job<a class="headerlink" href="#create-a-recovery-testing-job" title="Link to this heading">#</a></h3>
<p>To create a recovery testing job, do the following:</p>
<ol class="arabic">
<li><p>From the menu, click <strong>Restore</strong>. The restore job wizard appears.</p></li>
<li><p>At the <strong>Hosts and resources</strong> step, select the host where PostgreSQL resides and select the instance. The wizard goes to the next step automatically.</p></li>
<li><p>At the <strong>Backup sets</strong> step, do the following:</p>
<p>(1) From the <strong>Restore type</strong> list, select <strong>Recovery testing</strong>.</p>
<p>(2) In the <strong>Restore source</strong> section, select databases for the restore job. If you want to rename the restore source, click the database. The <strong>Rename</strong> icon appears beside the name. Click the icon and specify a name in the pop-up window.</p>
<p>(3) Click <strong>Next</strong>.</p>
</li>
<li><p>At the <strong>Restore target</strong> step, select a restore target. The wizard automatically goes to the next step. The restore target supports other instances on the original or a different host.</p></li>
<li><p>At the <strong>Restore schedule</strong> step, set the job schedule. Click <strong>Next</strong>.</p>
<ul class="simple">
<li><p>Select <strong>Hourly</strong>. Set the start time, end time, and time interval to specify the time range for job execution. The unit can be hour(s) or minute(s).</p></li>
<li><p>Select <strong>Daily</strong>. Set the start time and enter the time interval for job execution. The unit is day(s).</p></li>
<li><p>Select <strong>Weekly</strong>. Set the start time, enter the time interval, and select the specific dates in a week for job execution. The unit is week.</p></li>
<li><p>Select <strong>Monthly</strong>. Set the start time and months for job execution. You can select the natural dates in one month or select the specific dates in one week.</p></li>
</ul>
</li>
<li><p>At the <strong>Restore options</strong> step, set the options according to your needs. See <a class="reference internal" href="#restore-options">Restore options</a>. Click <strong>Next</strong>.</p></li>
<li><p>At the <strong>Finish</strong> step, set the job name and confirm the job information. Click <strong>Submit</strong>.</p></li>
<li><p>After submission, you will be redirected to the <strong>Job</strong> page. You can start, modify, and delete the job.</p></li>
</ol>
</section>
<section id="restore-options">
<h3>Restore options<a class="headerlink" href="#restore-options" title="Link to this heading">#</a></h3>
<p>ADPS provides the following restore options for PostgreSQL:</p>
<ul class="simple">
<li><p>Common options:</p></li>
</ul>
<table class="longtable table" id="id6">
<caption><span class="caption-text">Restore advanced options</span><a class="headerlink" href="#id6" title="Link to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Limitations</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Channels</p></td>
<td><p>It can improve backup efficiency. The default value is 1. The maximum value for the range should not exceed the maximum number of channels set in the selected backup set.</p></td>
<td><p>Only available for point-in-time restore jobs.</p></td>
</tr>
<tr class="row-odd"><td><p>Open database after restore</p></td>
<td><p>After this option is enabled, the database will automatically start upon successful recovery. It is checked by default.</p></td>
<td><p>Only available for point-in-time restore jobs.</p></td>
</tr>
<tr class="row-even"><td><p>Restore database</p></td>
<td><p>Leave the field blank to overwrite the original database. To restore to a new database, enter the new database name.</p></td>
<td><p>Only available for logical recovery jobs.</p></td>
</tr>
<tr class="row-odd"><td><p>Archive log destination</p></td>
<td><p>Set the restore directory for archive logs.</p></td>
<td><p>Only available for log restore jobs.</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>Advanced options:</p></li>
</ul>
<table class="longtable table" id="id7">
<caption><span class="caption-text">Restore advanced options</span><a class="headerlink" href="#id7" title="Link to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Limitations</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Reconnection time</p></td>
<td><p>The value ranges from 1 to 60 minutes. The job continues after the abnormal reset occurs in the network within the set time.</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>Resumption buffer size</p></td>
<td><p>Specifies the resumption buffer size. The default value is 10 MiB. The bigger the resumption buffer size is, the more physical storage will be consumed. However, a bigger resumption buffer size can prevent data loss when the throughput of the business system is high.</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>Speed limit</p></td>
<td><p>Limits data transfer speed or disk read/write speed for different time periods. The unit can be KiB/s, MiB/s, and GiB/s.</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>Precondition</p></td>
<td><p>Checked before the job starts. The job execution will be aborted and the job state will be idle when the precondition is invalid.</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>Pre-/Post-script</p></td>
<td><p>The pre-script is executed after the job starts and before the resource is restored. The post-script is executed after the resource is restor.</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>Database configuration file</p></td>
<td><p>Click <strong>Browse</strong> to select a path or manually enter the path for the PostgreSQL configuration file of the restore target. If the option is left blank, the configuration file from the backup set will be used by default.</p></td>
<td><p>Only available for point-in-time restore jobs.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="cluster-backup-and-restore">
<h2>Cluster backup and restore<a class="headerlink" href="#cluster-backup-and-restore" title="Link to this heading">#</a></h2>
<p>ADPS supports the backup and restore of PostgreSQL master-slave clusters. Before you back up and restore the PostgreSQL cluster, bind nodes into a cluster on the console.</p>
<section id="id2">
<h3>Before you begin<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>See <a class="reference internal" href="#install-and-configure-the-agent">Install and configure the agent</a> and <a class="reference internal" href="#activate-licenses-and-authorize-users">Activate license and authorize users</a> to complete the environment deployment on each node.</p>
</section>
<section id="bind-nodes-into-a-cluster">
<h3>Bind nodes into a cluster<a class="headerlink" href="#bind-nodes-into-a-cluster" title="Link to this heading">#</a></h3>
<p>To bind nodes into a cluster on the console, do the following:</p>
<ol class="arabic">
<li><p>From the menu, click <strong>Resource</strong> &gt; <strong>Cluster</strong>. The <strong>Cluster</strong> page appears.</p></li>
<li><p>From the toolbar, click the <strong>+</strong> icon. The <strong>Cluster binding</strong> window appears.</p>
</li>
<li><p>In the <strong>Cluster binding</strong> window, do the following:</p>
<p>(1) In the <strong>Name</strong> field, enter a name for the cluster.</p>
<p>(2) From the <strong>Primary node</strong> list, select the active node in the cluster.</p>
<p>(3) From the <strong>Type</strong> list, select <strong>Master slave replication</strong>.</p>
<p>(4) From the <strong>Nodes</strong> list, select the inactive node in the cluster. You can click <strong>x</strong> to remove the selected node.</p>
<p>(5) Click <strong>Submit</strong>.</p>
</li>
</ol>
</section>
<section id="backup-and-restore">
<h3>Backup and restore<a class="headerlink" href="#backup-and-restore" title="Link to this heading">#</a></h3>
<p>When a switchover occurs, the new primary node will take over the backup job automatically. To create a PostgreSQL cluster backup/restore job, see <a class="reference internal" href="#create-a-backup-job">Create a backup job</a> and <a class="reference internal" href="#restore">Restore</a>. Note that:</p>
<ol class="arabic simple">
<li><p>On the backup job wizard, only the active nodes of the PostgreSQL cluster are displayed.</p></li>
<li><p>In the event of a switchover within the PostgreSQL cluster, the new active node automatically takes over the backup job.</p></li>
<li><p>On the restore job wizard, one instance or cluster can be selected as the restore target.</p></li>
</ol>
</section>
</section>
<section id="limitations">
<h2>Limitations<a class="headerlink" href="#limitations" title="Link to this heading">#</a></h2>
<table class="longtable table" id="id8">
<caption><span class="caption-text">Limitations</span><a class="headerlink" href="#id8" title="Link to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Feature</p></th>
<th class="head"><p>Limitations</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Resources</p></td>
<td><p>- ADPS does not support PostgreSQL cluster on Windows. <br> - After cluster binding, all nodes must be online for job creation. <br> - Once the cluster is configured, the primary node cannot be changed unless the entire cluster is deleted.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="glossary">
<h2>Glossary<a class="headerlink" href="#glossary" title="Link to this heading">#</a></h2>
<table class="longtable table" id="id9">
<caption><span class="caption-text">Glossary</span><a class="headerlink" href="#id9" title="Link to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Term</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>fast compression</p></td>
<td><p>A compression method that uses fast compression algorithms to compress data during the backup job.</p></td>
</tr>
</tbody>
</table>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../informix/informix.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">User Guide for Informix</p>
      </div>
    </a>
    <a class="right-next"
       href="../cachedb/cachedb.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">User Guide for Caché</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#planning-and-preparation">Planning and preparation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#install-and-configure-the-agent">Install and configure the agent</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-the-compatibility">Verify the compatibility</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#install-the-agent">Install the agent</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#windows">Windows</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#linux">Linux</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#activate-licenses-and-authorize-users">Activate licenses and authorize users</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#backup">Backup</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#backup-types">Backup types</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#backup-policies">Backup policies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#before-you-begin">Before you begin</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#log-in-to-the-resource">Log in to the resource</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-backup-job">Create a backup job</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#backup-options">Backup options</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#restore">Restore</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#restore-types">Restore types</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Before you begin</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-point-in-time-restore-job">Create a point-in-time restore job</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-logical-recovery-job">Create a logical recovery job</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-log-restore-job">Create a log restore job</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-recovery-testing-job">Create a recovery testing job</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#restore-options">Restore options</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cluster-backup-and-restore">Cluster backup and restore</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Before you begin</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bind-nodes-into-a-cluster">Bind nodes into a cluster</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#backup-and-restore">Backup and restore</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#limitations">Limitations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#glossary">Glossary</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Aurreum
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  Copyright © 2022-2024 Aurreum
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>