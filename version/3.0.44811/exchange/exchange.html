
<!DOCTYPE html>


<html lang="en-US" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>User Guide for Microsoft Exchange Server &#8212; ADPS V3.0.44811</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css?v=84d92f63" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=6da122b0"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'exchange/exchange';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="User Guide for Linux OS" href="../linux_os/linux_os.html" />
    <link rel="prev" title="User Guide for Object Storage" href="../obs/obs.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en-US"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="ADPS V3.0.44811 - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="ADPS V3.0.44811 - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Deployment</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../install/install.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agent_install/agent_install.html">Agent Installation Guide</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Management</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../manager/manager.html">Administrator’s Guide</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Databases</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../oracle/oracle.html">User Guide for Oracle</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mysql/mysql.html">User Guide for MySQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mssql/mssql.html">User Guide for Microsoft SQL Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../db2/db2.html">User Guide for DB2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sybase/sybase.html">User Guide for Sybase</a></li>
<li class="toctree-l1"><a class="reference internal" href="../informix/informix.html">User Guide for Informix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../postgresql/postgresql.html">User Guide for PostgreSQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cachedb/cachedb.html">User Guide for Caché</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hana/hana.html">User Guide for SAP HANA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mariadb/mariadb.html">User Guide for MariaDB</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Files</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../file/file.html">User Guide for File</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ndmp/ndmp.html">User Guide for NDMP</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Big Data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../mongodb/mongodb.html">User Guide for MongoDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hadoop/hadoop.html">User Guide for Hadoop</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Object Storage</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../obs/obs.html">User Guide for Object Storage</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Applications</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">User Guide for Microsoft Exchange Server</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Operating Systems</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../linux_os/linux_os.html">User Guide for Linux OS</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Containers</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../k8s/k8s.html">User Guide for Kubernetes</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Virtualization</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../vmware/vmware.html">User Guide for VMware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../openstack/openstack.html">User Guide for OpenStack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyper_v/hyper_v.html">User Guide for Hyper-V</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">



<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>User Guide for Microsoft Exchange Server</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#planning-and-preparation">Planning and preparation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#install-and-configure-the-agent">Install and configure the agent</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-the-compatibility">Verify the compatibility</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#install-the-agent">Install the agent</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#activate-licenses-and-authorize-users">Activate licenses and authorize users</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#backup">Backup</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#backup-types">Backup types</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#backup-policies">Backup policies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exchange-versions-for-backup-types">Exchange versions for backup types</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exchange-server-backup-and-restore-account">Exchange Server backup and restore account</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#before-you-begin">Before you begin</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#log-in-to-the-resource">Log in to the resource</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-database-backup-job">Create a database backup job</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-mailbox-backup-job">Create a mailbox backup job</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-dag-backup-job">Create a DAG backup job</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-dag-mailbox-backup-job">Create a DAG mailbox backup job</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#backup-options">Backup options</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#restore">Restore</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#restore-types">Restore types</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Before you begin</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-point-in-time-restore-job">Create a point-in-time restore job</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-mailbox-recovery-job">Create a mailbox recovery job</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-dag-point-in-time-restore-job">Create a DAG point-in-time restore job</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Before you begin</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-dag-mailbox-recovery-job">Create a DAG mailbox recovery job</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#restore-options">Restore options</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#glossary">Glossary</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="user-guide-for-microsoft-exchange-server">
<h1>User Guide for Microsoft Exchange Server<a class="headerlink" href="#user-guide-for-microsoft-exchange-server" title="Link to this heading">#</a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>This guide introduces how to install and configure the ADPS agent, and how to properly use ADPS to back up and restore Exchange Server.</p>
<p>The backup and restore features supported by ADPS include:</p>
<ul>
<li><p>Backup sources</p>
<p>Single or multiple databases and mailboxes</p>
</li>
<li><p>Backup types</p>
<p>Snapshot (VSS) backup (full backup and incremental backup), streaming backup (full backup and log backup), and mailbox backup (EWS mailbox backup and MAPI mailbox backup)</p>
</li>
<li><p>Backup targets</p>
<p>Standard storage pool, deduplication storage pool, local storage pool, tape library pool, object storage service pool, and LAN-free pool</p>
</li>
<li><p>Backup schedules</p>
<p>Immediate, one-time, hourly, daily, weekly, and monthly</p>
</li>
<li><p>Data processing</p>
<p>Data compression, multiple channels, reconnection, and speed limit</p>
</li>
<li><p>Restore types</p>
<p>Point-in-time restore, EWS mailbox recovery</p>
</li>
<li><p>Restore targets</p>
<p>Original host, different host (same version required)</p>
</li>
</ul>
</section>
<section id="planning-and-preparation">
<h2>Planning and preparation<a class="headerlink" href="#planning-and-preparation" title="Link to this heading">#</a></h2>
<p>Before you install the agent, check the following prerequisites:</p>
<ol class="arabic simple">
<li><p>You have already installed and configured other backup components, including the backup server and the storage server.</p></li>
<li><p>You have created a user with roles of operator and administrator on the ADPS console. Log in to the console with this user to back up and restore the resource.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The administrator role can install and configure agents, activate licenses, and authorize users. The operator role can create backup/restore jobs and conduct copy data management (CDM).</p>
</div>
</section>
<section id="install-and-configure-the-agent">
<h2>Install and configure the agent<a class="headerlink" href="#install-and-configure-the-agent" title="Link to this heading">#</a></h2>
<p>To back up and restore Exchange Server, first install the ADPS agent on the host where Exchange Server resides.</p>
<section id="verify-the-compatibility">
<h3>Verify the compatibility<a class="headerlink" href="#verify-the-compatibility" title="Link to this heading">#</a></h3>
<p>ADPS supports the backup and restore of Exchange Server in standalone mode and Exchange Server Database Availability Group (DAG). Before you install the agent, ensure that the environment of the host where Exchange Server resides is on the Aurreum Data Protection Suite’s compatibility lists.</p>
<p>ADPS supports the backup and restore of Exchange Server, including:</p>
<ul class="simple">
<li><p>Exchange Server 2000/2003/2007/2010/2013/2016/2019</p></li>
</ul>
</section>
<section id="install-the-agent">
<h3>Install the agent<a class="headerlink" href="#install-the-agent" title="Link to this heading">#</a></h3>
<p>ADPS agent can be installed on Windows.</p>
<p>To install the agent, do the following:</p>
<ol class="arabic">
<li><p>Log in to the ADPS console.</p></li>
<li><p>From the menu, click <strong>Resource</strong> &gt; <strong>Resource</strong>. The <strong>Resource</strong> page appears.</p></li>
<li><p>From the toolbar, click the <strong>Install agent</strong> icon. The <strong>Install agent</strong> window appears.</p></li>
<li><p>In the <strong>Install agent</strong> window, do the following:</p>
<p>(1) From the <strong>Select system</strong> list, select <strong>Windows</strong>.</p>
<p>(2) From the <strong>Select file</strong> list, select the package that you want to install.</p>
<p>(3) Click <strong>Download</strong>.</p>
</li>
<li><p>Upload the package to the Windows host.</p></li>
<li><p>Log in to the Windows host as a user with administrative privileges. Double-click the package and open the installation wizard. Click <strong>Next</strong>.</p></li>
<li><p>At the <strong>Select components</strong> step, select <strong>Microsoft Exchange Server</strong> from the component list. Click <strong>Next</strong>.</p></li>
<li><p>At the <strong>Configure Aurreum Data Protection Suite agent</strong> step, enter the following:</p>
<p>(1) In the <strong>Backup server address</strong> field, enter the IP or domain name of the backup server.</p>
<p>(2) In the <strong>Backup server port</strong> field, enter the port number. The default value is 50305. If you enable the <strong>Use SSL secure connection</strong> option, enter 60305 in the <strong>Backup server port</strong> field.</p>
<p>(3) The <strong>Access key</strong> field is optional and blank by default. If your backup server adopts multi-tenancy, you must enter the access key of the tenant for the agent.</p>
<p>(4) Click <strong>Next</strong>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To get the access key of the user/tenant:</p>
<ol class="arabic simple">
<li><p>Log in to the ADPS console.</p></li>
<li><p>On the upper right corner, click your avatar, and go to <strong>Personal settings</strong> &gt; <strong>Account settings</strong>.</p></li>
<li><p>On the <strong>Preference</strong> tab, click <strong>View</strong> to get the access key of the current user/tenant.</p></li>
</ol>
</div>
</li>
<li><p>Confirm the <strong>Destination folder</strong> or specify another folder. Click <strong>Next</strong>.</p></li>
<li><p>Wait for the installation to complete.</p></li>
</ol>
</section>
</section>
<section id="activate-licenses-and-authorize-users">
<h2>Activate licenses and authorize users<a class="headerlink" href="#activate-licenses-and-authorize-users" title="Link to this heading">#</a></h2>
<p>After the agent installation, go back to the <strong>Resource</strong> page. The host with the agent installed appears on the page. Before you back up and restore Exchange Server, register the host, activate the backup license, and authorize users.</p>
<p>To activate licenses and authorize users, do the following:</p>
<ol class="arabic">
<li><p>From the menu, click <strong>Resource</strong> &gt; <strong>Resource</strong>. The <strong>Resource</strong> page appears.</p></li>
<li><p>On the <strong>Resource</strong> page, select the host where Exchange Server resides. Click the <strong>Register</strong> icon. Then the <strong>Activate</strong> window appears.</p></li>
<li><p>In the <strong>Activate</strong> window, select the Exchange Server backup license, and click <strong>Submit</strong>. After the activation, the <strong>Authorize</strong> window appears.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are prompted with “No enough licenses”, contact the administrator to add licenses.</p>
</div>
</li>
<li><p>In the <strong>Authorize</strong> window, select user groups to authorize access to the resource. Click <strong>Submit</strong>.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>With many agents, install them first, then <strong>batch register</strong>, <strong>batch activate</strong>, and <strong>batch authorize</strong> the agents and resources for convenience. For details, see <a class="reference internal" href="../manager/manager.html#batch-register-batch-activate-batch-authorize"><span class="std std-ref">Batch register/Batch activate/Batch authorize</span></a> in Aurreum Data Protection Suite Administrator’s Guide.</p>
</div>
</section>
<section id="backup">
<h2>Backup<a class="headerlink" href="#backup" title="Link to this heading">#</a></h2>
<section id="backup-types">
<h3>Backup types<a class="headerlink" href="#backup-types" title="Link to this heading">#</a></h3>
<p>ADPS provides four backup types for Exchange Server: full backup, incremental backup, log backup, and mailbox backup (EWS mailbox backup, MAPI mailbox backup).</p>
<ul>
<li><p>Full backup</p>
<p>Backs up all data in one or multiple databases.</p>
</li>
<li><p>Incremental backup</p>
<p>Backs up only the data that has changed since the last backup with a full backup or incremental backup as the baseline.</p>
</li>
<li><p>Log backup</p>
<p>Backs up transaction logs with a full backup as the baseline. It is possible to specify a point in time when transaction logs are used for restore. Compared to full backups, backing up transaction logs is more efficient in terms of time and space. In addition, the transaction logs are truncated to prevent log files from getting huge.</p>
</li>
<li><p>Mailbox backup (EWS mailbox backup and MAPI mailbox backup).</p>
<p>EWS email backup only backs up the folders visible in Outlook Top of Information Store, while MAPI email backup can back up the entire mailbox directory.</p>
</li>
</ul>
</section>
<section id="backup-policies">
<h3>Backup policies<a class="headerlink" href="#backup-policies" title="Link to this heading">#</a></h3>
<p>ADPS provides six backup schedule types: immediate, one-time, hourly, daily, weekly, and monthly.</p>
<ul class="simple">
<li><p>Immediate: ADPS will immediately start the job after it is created.</p></li>
<li><p>One-time: ADPS will perform the job at the specified time once only.</p></li>
<li><p>Hourly: ADPS will perform the job periodically at the specified hour/minute intervals within the time range according to the setting.</p></li>
<li><p>Daily: ADPS will perform the job periodically at the specified time and day intervals.</p></li>
<li><p>Weekly: ADPS will perform the job periodically at the specified time and week intervals.</p></li>
<li><p>Monthly: ADPS will perform the job periodically at the specified dates and times.</p></li>
</ul>
<p>You can set an appropriate backup policy based on your situation and requirements. Usually, we recommend the following common backup policy:</p>
<ol class="arabic simple">
<li><p>Snapshot (VSS) backup (full backup): Perform a <strong>full backup</strong> once a week when the application traffic is relatively small (Example: on the weekend) to ensure that you have a recoverable point in time every week.</p></li>
<li><p>Snapshot (VSS) backup (incremental backup): Perform an <strong>incremental backup</strong> every day when the application traffic is relatively small (Example: at 2 a.m.) to ensure that you have a recoverable point in time every day, which can save storage space and backup time.</p></li>
<li><p>Streaming backup (full backup): Perform a <strong>full backup</strong> once a week if your database supports streaming backup when the application traffic is relatively small (Example: on the weekend) to ensure that you have a recoverable point in time every week.</p></li>
<li><p>Streaming backup (log backup): Perform a <strong>log backup</strong> hourly if your database supports log backup to ensure that you have a second-level point in time available everyday.</p></li>
<li><p>Mailbox backup: Perform a <strong>mailbox backup</strong> every day when the application traffic is relatively small (Example: at 2 a.m.) to ensure that you have a recoverable point in time every day, which can save storage space and backup time.</p></li>
</ol>
</section>
<section id="exchange-versions-for-backup-types">
<h3>Exchange versions for backup types<a class="headerlink" href="#exchange-versions-for-backup-types" title="Link to this heading">#</a></h3>
<p>Please refer to the following table for the available backup types corresponding to different Exchange versions:</p>
<table class="longtable table" id="id3">
<caption><span class="caption-text">Exchange versions for backup types</span><a class="headerlink" href="#id3" title="Link to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Backup type</p></th>
<th class="head"><p>Exchange versions</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>VSS backup</p></td>
<td><p>Available for Exchange Server 2003 and above. <br>  Snapshot (VSS) incremental backup is not available for Exchange Server 2003.</p></td>
</tr>
<tr class="row-odd"><td><p>Streaming backup</p></td>
<td><p>Only available for Exchange Server 2000, Exchange Server 2003 and Exchange Server 2007.  <br> Exchange Server 2007 and newer versions no longer support the Streaming API.</p></td>
</tr>
<tr class="row-even"><td><p>MAPI mailbox backup</p></td>
<td><p>Only available for Exchange Server 2007, Exchange Server 2010 and Exchange Server 2013. <br> Exchange Server 2007 and newer versions no longer support the MAPI API.</p></td>
</tr>
<tr class="row-odd"><td><p>EWS mailbox backup</p></td>
<td><p>Available for Exchange Server 2010 and above.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="exchange-server-backup-and-restore-account">
<h3>Exchange Server backup and restore account<a class="headerlink" href="#exchange-server-backup-and-restore-account" title="Link to this heading">#</a></h3>
<p>To configure a backup and restore account of Exchange Server, do the following:</p>
<ol class="arabic simple">
<li><p>Create a new mailbox as the backup and restore account. After creation, the mailbox will automatically become a new account in the domain.</p></li>
</ol>
<ul>
<li><p>For Exchange Server 2010:</p>
<p>(1) Log in to the host where the Exchange Server resides, open the Exchange Server management console, expand the <strong>Recipient Configuration</strong>, right-click <strong>Mailbox</strong>, and select <strong>New Mailbox…</strong>.</p>
<p>(2) Create a new Exchange mailbox according to the prompts and set a username such as xxxxBackupUser.</p>
</li>
<li><p>For Exchange Server 2013 and above versions:</p>
<p>(1) Log in to the Exchange Web Admin Center. On the <strong>Recipients</strong> page, click <strong>+</strong> and select <strong>User mailbox</strong></p>
<p>(2) Create a new Exchange mailbox according to the prompts and set a username such as xxxxBackupUser.</p>
</li>
</ul>
<ol class="arabic" start="2">
<li><p>To log in to Exchange Server on the ADPS console, the account must be a member of Domain Admins. On the domain controller, open <strong>Active Directory Users and Computers</strong>, double-click the new account, select <strong>Member of</strong>, and click <strong>Add</strong> to add this user to Domain Admins. Click <strong>OK</strong>.</p></li>
<li><p>To add Exchange Server credentials in the host properties, create a new role group and add the new account to the group. Open Exchange Management Shell and do the following:</p>
<p>(1) Create a role group: Create a role group named xxxxBackupRoles.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>New-RoleGroup<span class="w"> </span>-Name<span class="w"> </span>xxxBackupRoles<span class="w"> </span>-Roles<span class="w"> </span>@（<span class="s2">&quot;Database Copies&quot;</span>，<span class="s2">&quot;Databases&quot;</span>，<span class="s2">&quot;Exchange Servers&quot;</span>，<span class="s2">&quot;Monitoring&quot;</span>，<span class="s2">&quot;Mail Recipient Creation&quot;</span>，<span class="s2">&quot;Mail Recipients&quot;</span>，<span class="s2">&quot;Recipient Policies&quot;</span>，<span class="s2">&quot;View-Only Configuration&quot;</span>）
</pre></div>
</div>
<p>(2) Add a role group member: Add xxxxBackupUser into the xxxxBackupUser role group.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>Add-RoleGroupMember<span class="w"> </span>-Identity<span class="w"> </span>xxxBackupRoles<span class="w"> </span>-Member<span class="w"> </span>xxxBackupUser
</pre></div>
</div>
</li>
<li><p>To back up EWS mailboxes, do the following on the Exchange Management Shell:</p>
<p>(1) Create management roles: Based on the parent role ApplicationImpersonation, create a management role named xxxEWSImpersonationRole.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>New-ManagementRole<span class="w"> </span>-Name<span class="w"> </span>xxxEWSImpersonationRole<span class="w"> </span>-Parent<span class="w"> </span>ApplicationImpersonation
</pre></div>
</div>
<p>(2) Assign management roles: Assign xxxEWSImpersonationRole to xxxBackupUser.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>New-ManagementRoleAssignment<span class="w"> </span>-Role<span class="w"> </span>xxxEWSImpersonationRole<span class="w"> </span>-User<span class="w"> </span>xxxBackupUser<span class="w"> </span>-Name<span class="w"> </span><span class="s2">&quot;xxxBackupUser-EWSImpersonation&quot;</span>
</pre></div>
</div>
<p>(3) Create a new throttling policy for Exchange 2010: Create an unlimited EWS throttling policy.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>New-ThrottlingPolicy<span class="w"> </span>-Name<span class="w"> </span><span class="s2">&quot;xxxEWSThrottlingPolicy&quot;</span><span class="w"> </span>-EWSPercentTimeInCAS<span class="w"> </span><span class="nv">$null</span><span class="w"> </span>-EWSPercentTimeInAD<span class="w"> </span><span class="nv">$null</span><span class="w"> </span>-EWSMaxConcurrency<span class="w"> </span><span class="nv">$null</span><span class="w"> </span>-EWSPercentTimeInMailboxRPC<span class="w"> </span><span class="nv">$null</span><span class="w"> </span>-PowerShellMaxConcurrency<span class="w"> </span><span class="nv">$null</span>
</pre></div>
</div>
<p>(4) Create a new throttling policy for Exchange 2013 and later: Create an unlimited EWS throttling policy</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>New-ThrottlingPolicy<span class="w"> </span>-Name<span class="w"> </span><span class="s2">&quot;xxxEWSThrottlingPolicy&quot;</span><span class="w"> </span>-EwsCutoffBalance<span class="w"> </span><span class="s2">&quot;Unlimited&quot;</span><span class="w"> </span>-EwsMaxBurst<span class="w"> </span><span class="s2">&quot;Unlimited&quot;</span><span class="w"> </span>-EwsMaxConcurrency<span class="w"> </span><span class="s2">&quot;Unlimited&quot;</span><span class="w"> </span>-ExchangeMaxCmdlets<span class="w"> </span><span class="s2">&quot;Unlimited&quot;</span><span class="w"> </span>-MessageRateLimit<span class="w"> </span><span class="s2">&quot;Unlimited&quot;</span><span class="w"> </span>-PowerShellCutoffBalance<span class="w"> </span><span class="s2">&quot;Unlimited&quot;</span><span class="w"> </span>-PowerShellMaxBurst<span class="w"> </span><span class="s2">&quot;Unlimited&quot;</span><span class="w"> </span>-PowerShellMaxCmdlets<span class="w"> </span><span class="s2">&quot;Unlimited&quot;</span><span class="w"> </span>-PowerShellMaxConcurrency<span class="w"> </span><span class="s2">&quot;Unlimited&quot;</span><span class="w"> </span>-PowerShellMaxOperations<span class="w"> </span><span class="s2">&quot;Unlimited&quot;</span><span class="w"> </span>-RecipientRateLimit<span class="w"> </span><span class="s2">&quot;Unlimited&quot;</span><span class="w"> </span>-ThrottlingPolicyScope<span class="w"> </span><span class="s2">&quot;Regular&quot;</span>
</pre></div>
</div>
<p>(5) Set the mailbox policy: Assign xxxxEWSThrottlingPolicy to xxxxBackupUser</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>Set-Mailbox<span class="w"> </span>-Identity<span class="w"> </span>xxxBackupUser<span class="w"> </span>-ThrottlingPolicy<span class="w"> </span><span class="s2">&quot;xxxEWSThrottlingPolicy&quot;</span>
</pre></div>
</div>
</li>
<li><p>Enable the Basic Identity Authentication for EWS mailbox backup: IIS -&gt; Default Web Site -&gt; EWS -&gt; Identity Authentication -&gt; Enable Basic Identity Authentication.</p></li>
<li><p>Open the Exchange Management Console, expand <strong>Recipient Configuration</strong>, click <strong>Mailboxes</strong>, and select the mailbox that you want to back up. Right-click the mailbox and <strong>select Manage Full Access Permission</strong>. Add xxxxBackupUser that you create in the first step. Click <strong>OK</strong>. This operation is required for MAPI mailbox backup but not for EWS mailbox backup.</p></li>
</ol>
</section>
<section id="before-you-begin">
<h3>Before you begin<a class="headerlink" href="#before-you-begin" title="Link to this heading">#</a></h3>
<p>Before you back up and restore Exchange Server, check the following:</p>
<ol class="arabic">
<li><p>Check the Exchange Server instance status</p>
<p>(1) Run Windows PowerShell as administrator on Windows.</p>
<p>(2) Enter the following command in Windows PowerShell windows.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>Get-Service<span class="w"> </span>*Exchange*
</pre></div>
</div>
<p>This command will display all the relevant services of Exchange Server along with their status. If all the services are running, you should see the status of each service as “Running”.</p>
</li>
<li><p>Check the circular logging is not enabled for Exchange Server database on Windows.</p></li>
<li><p>Check storage pools</p>
<p>(1) From the menu, click <strong>Storage</strong> &gt; <strong>Storage pool</strong>. The <strong>Storage pool</strong> page appears.</p>
<p>(2) Check whether the display area has any storage pools. If there is no storage pool, create a storage pool and authorize it for the current user. For details, see <a class="reference internal" href="../manager/manager.html#add-a-storage-pool"><span class="std std-ref">Add a storage pool</span></a> in Aurreum Data Protection Suite Administrator’s Guide.</p>
</li>
</ol>
</section>
<section id="log-in-to-the-resource">
<h3>Log in to the resource<a class="headerlink" href="#log-in-to-the-resource" title="Link to this heading">#</a></h3>
<p>Before you create a backup or restore job, log in to the Exchange Server resource on the console.</p>
<p>To log in to the resource, do the following:</p>
<ol class="arabic simple">
<li><p>From the menu, click <strong>Resource</strong> &gt; <strong>Resource</strong>. The <strong>Resource</strong> page appears.</p></li>
<li><p>From the host list, find the host where Exchange Server resides. If you have many hosts, use the search bar to find the host quickly. Click the host to expand its resource list.</p></li>
<li><p>Click <strong>Login</strong> beside the resource. The <strong>Login</strong> window appears.</p>
</li>
<li><p>In the <strong>Login</strong> window, enter the <strong>User</strong> and <strong>Password</strong> of the backup account.</p></li>
<li><p>If your information is correct, you will be prompted that you have logged in to the resource successfully.</p></li>
</ol>
</section>
</section>
<section id="create-a-database-backup-job">
<h2>Create a database backup job<a class="headerlink" href="#create-a-database-backup-job" title="Link to this heading">#</a></h2>
<p>To create a database backup job, do the following:</p>
<ol class="arabic">
<li><p>From the menu, click <strong>Backup</strong>. The backup job wizard appears.</p></li>
<li><p>At the <strong>Hosts and resources</strong> step, select the host where Exchange Server resides and select the resource. The wizard goes to the next step automatically.</p></li>
<li><p>At the <strong>Backup source</strong> step, do the following:</p>
<p>(1) From the <strong>Backup type</strong> list, select a backup type.</p>
<p>(2) In the <strong>Backup source</strong> section, select the databases that you want to back up.</p>
</li>
<li><p>At the <strong>Backup target</strong> step, select a storage pool. Click <strong>Next</strong>.</p></li>
<li><p>At the <strong>Backup schedule</strong> step, set the job schedule. For details, see <a class="reference internal" href="#backup-policies">Backup policies</a>. Click <strong>Next</strong>.</p>
<ul class="simple">
<li><p>Select <strong>Immediate</strong>. ADPS performs the job immediately after it is created.</p></li>
<li><p>Select <strong>One time</strong> and set the start time for the job.</p></li>
<li><p>Select <strong>Hourly</strong>. Set the start time, end time, and time interval for job execution. The unit can be hour(s) or minute(s).</p></li>
<li><p>Select <strong>Daily</strong>. Set the start time and enter the time interval for job execution. The unit is day(s).</p></li>
<li><p>Select <strong>Weekly</strong>. Set the start time, enter the time interval, and select the specific dates in a week for job execution. The unit is week.</p></li>
<li><p>Select <strong>Monthly</strong>. Set the start time and months for job execution. You can select the natural dates in one month or select the specific dates in one week.</p></li>
</ul>
</li>
<li><p>At the <strong>Backup options</strong> step, set the common and advanced options according to your needs. For details, see <a class="reference internal" href="#backup-options">Backup options</a>. Click <strong>Next</strong>.</p></li>
</ol>
<ol class="arabic simple" start="7">
<li><p>At the <strong>Finish</strong> step, set the job name and confirm the job information. Click <strong>Submit</strong>.</p></li>
<li><p>After the submission, you will be redirected to the <strong>Job</strong> page automatically. On this page, you can start, modify, and delete the job.</p></li>
</ol>
</section>
<section id="create-a-mailbox-backup-job">
<h2>Create a mailbox backup job<a class="headerlink" href="#create-a-mailbox-backup-job" title="Link to this heading">#</a></h2>
<p>To create a mailbox backup job, do the following:</p>
<ol class="arabic">
<li><p>From the menu, click <strong>Backup</strong>. The backup job wizard appears.</p></li>
<li><p>At the <strong>Hosts and resources</strong> step, select the host where Exchange Server resides and select the resource. The wizard goes to the next step automatically.</p></li>
<li><p>At the <strong>Backup source</strong> step, do the following:</p>
<p>(1) From the <strong>Backup type</strong> list, select a backup type.</p>
<p>(2) In the <strong>Backup source</strong> section, select the mailboxes that you want to back up.</p>
</li>
<li><p>At the <strong>Backup target</strong> step, select a storage pool. Click <strong>Next</strong>.</p></li>
<li><p>At the <strong>Backup schedule</strong> step, set the job schedule. For details, see <a class="reference internal" href="#backup-policies">Backup policies</a>. Click <strong>Next</strong>.</p>
<ul class="simple">
<li><p>Select <strong>Immediate</strong>. ADPS performs the job immediately after it is created.</p></li>
<li><p>Select <strong>One time</strong> and set the start time for the job.</p></li>
<li><p>Select <strong>Hourly</strong>. Set the start time, end time, and time interval for job execution. The unit can be hour(s) or minute(s).</p></li>
<li><p>Select <strong>Daily</strong>. Set the start time and enter the time interval for job execution. The unit is day(s).</p></li>
<li><p>Select <strong>Weekly</strong>. Set the start time, enter the time interval, and select the specific dates in a week for job execution. The unit is week.</p></li>
<li><p>Select <strong>Monthly</strong>. Set the start time and months for job execution. You can select the natural dates in one month or select the specific dates in one week.</p></li>
</ul>
</li>
<li><p>At the <strong>Backup options</strong> step, set the common and advanced options according to your needs. For details, see <a class="reference internal" href="#backup-options">Backup options</a>. Click <strong>Next</strong>.</p>
</li>
<li><p>At the <strong>Finish</strong> step, set the job name and confirm the job information. Click <strong>Submit</strong>.</p></li>
<li><p>After the submission, you will be redirected to the <strong>Job</strong> page automatically. On this page, you can start, modify, and delete the job.</p></li>
</ol>
<section id="create-a-dag-backup-job">
<h3>Create a DAG backup job<a class="headerlink" href="#create-a-dag-backup-job" title="Link to this heading">#</a></h3>
<p>The steps to create a DAG database backup job are similar to <a class="reference internal" href="#create-a-database-backup-job">Create a database backup job</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Exchange DAG database backup is performed on the node where the Exchange MBX role is installed. The node should be configured with an account for the backup and restore. The account configuration is the same as <a class="reference internal" href="#exchange-server-backup-and-restore-account">Exchange Server backup and restore account</a>.</p>
</div>
</section>
<section id="create-a-dag-mailbox-backup-job">
<h3>Create a DAG mailbox backup job<a class="headerlink" href="#create-a-dag-mailbox-backup-job" title="Link to this heading">#</a></h3>
<p>The steps to create a DAG mailbox backup job are similar to <a class="reference internal" href="#create-a-mailbox-backup-job">Create a mailbox backup job</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Exchange DAG mailbox backup is performed on the node where the Exchange MBX role or the CAS role is installed. The node should be configured with an account for the backup and restore. The account configuration is the same as the <a class="reference internal" href="#exchange-server-backup-and-restore-account">Exchange Server backup and restore account</a>.</p>
</div>
</section>
<section id="backup-options">
<h3>Backup options<a class="headerlink" href="#backup-options" title="Link to this heading">#</a></h3>
<p>ADPS provides the following backup options for Exchange Server:</p>
<ul class="simple">
<li><p>Common options</p></li>
</ul>
<table class="longtable table" id="id4">
<caption><span class="caption-text">Backup common options</span><a class="headerlink" href="#id4" title="Link to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Limitations</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Compression</p></td>
<td><p>Fast is enabled by default. <br> - None: No compression during the backup job. <br> - Tunable: Customizes the compression level. The Advanced Compression license is required.  <br> - Fast: Use the fast compression algorithms to compress data during the backup job.</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>Channels</p></td>
<td><p>It can improve backup efficiency. The default value is 1 and the value ranges from 1 to 255. <br> We recommend a value the same as the number of CPU cores. If the value exceeds the core number, the efficiency improvement will not be obvious. <br> </p></td>
<td><p>Not available for MAPI backup jobs.</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>Advanced options</p></li>
</ul>
<table class="longtable table" id="id5">
<caption><span class="caption-text">Backup advanced options</span><a class="headerlink" href="#id5" title="Link to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Limitations</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Reconnection time</p></td>
<td><p>The value ranges from 1 to 60 minutes. The job continues after the abnormal reset occurs in the network within the set time.</p></td>
<td><p>Not available for synthetic backup jobs.</p></td>
</tr>
<tr class="row-odd"><td><p>Resumption buffer size</p></td>
<td><p>Specifies the resumption buffer size. The default value is 10 MiB. The bigger the resumption buffer size is, the more physical storage will be consumed. However, a bigger resumption buffer size can prevent data loss when the throughput of the business system is high.</p></td>
<td><p>Not available for synthetic backup jobs.</p></td>
</tr>
<tr class="row-even"><td><p>Speed limit</p></td>
<td><p>Limits data transfer speed or disk read/write speed for different time periods. The unit can be KiB/s, MiB/s, and GiB/s.</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>Precondition</p></td>
<td><p>Checked before the job starts. The job execution will be aborted and the job state will be idle when the precondition is invalid.</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>Pre-/Post-script</p></td>
<td><p>The pre-script is executed after the job starts and before the resource is backed up. The post-script is executed after the resource is backed up.</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>Perform consistency check</p></td>
<td><p>Verifies the integrity of the database and log files before the backup job starts. If the consistency check fails, the backup job will be automatically terminated. By default, this feature is disabled.</p></td>
<td><p>Only available for snapshot (VSS) backup jobs.</p></td>
</tr>
<tr class="row-even"><td><p>Shadow copy provider</p></td>
<td><p>Specifies a shadow copy provider in the host to perform the synthetic backup job.</p></td>
<td><p>Only available for snapshot (VSS) backup jobs.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="restore">
<h2>Restore<a class="headerlink" href="#restore" title="Link to this heading">#</a></h2>
<section id="restore-types">
<h3>Restore types<a class="headerlink" href="#restore-types" title="Link to this heading">#</a></h3>
<p>For different needs, ADPS provides several restore types for Exchange Server, including:</p>
<ul>
<li><p>Point-in-time restore</p>
<p>When a logical error or disaster occurs in a Exchange Server database, you can perform a point-in-time restore job to restore the database to a specified point-in-time state. Restoring to the original or a different host is supported.</p>
</li>
<li><p>Mailbox recovery</p>
<p>When a disaster occurs in a Exchange Server mailbox, you can restore specific mailboxes or emails from a valid mailbox backup set using the mailbox recovery feature. To recover folders in Outlook Top of Information Store, select EWS mailbox recovery; to recover the entire mailbox directory, select MAPI mailbox recovery.</p>
</li>
</ul>
</section>
<section id="id1">
<h3>Before you begin<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>To restore Exchange Server to a different host, install the agent on that host, activate the licenses, and authorize user access to the resource.</p>
</section>
<section id="create-a-point-in-time-restore-job">
<h3>Create a point-in-time restore job<a class="headerlink" href="#create-a-point-in-time-restore-job" title="Link to this heading">#</a></h3>
<p>To create a point-in-time restore job, do the following:</p>
<ol class="arabic">
<li><p>From the menu, click <strong>Restore</strong>. The restore job wizard appears.</p></li>
<li><p>At the <strong>Hosts and resources</strong> step, select the host where Exchange Server resides and select the instance. The wizard goes to the next step automatically.</p></li>
<li><p>At the <strong>Backup sets</strong> step, do the following:</p>
<p>(1) From the <strong>Restore type</strong> list, select <strong>Point-in-time restore</strong>.</p>
<p>(2) From the <strong>Database</strong> list, select a database for the restore job.</p>
<p>(3) In the <strong>Restore point in time</strong> section, specify a point in time for the restore job.</p>
<p>(4) Click <strong>Next</strong>.</p>
</li>
<li><p>At the <strong>Restore target</strong> step, select a restore target. The wizard automatically goes to the next step.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Restoring to a different host requires the same Exchange versions.</p>
</div>
<ol class="arabic simple" start="5">
<li><p>At the <strong>Restore schedule</strong> step, set the job schedule. Click <strong>Next</strong>.</p>
<ul class="simple">
<li><p>Select <strong>Immediate</strong>. ADPS will perform the job immediately after its creation.</p></li>
<li><p>Select <strong>One time</strong> and set the start time for the job.</p></li>
</ul>
</li>
<li><p>At the <strong>Restore options</strong> step, set the options according to your needs. See <a class="reference internal" href="#restore-options">Restore options</a>. Click <strong>Next</strong>.</p></li>
<li><p>At the <strong>Finish</strong> step, set the job name and confirm the job information. Click <strong>Submit</strong>.</p></li>
<li><p>After the submission, you will be redirected to the <strong>Job</strong> page. You can start, modify, and delete the job.</p></li>
</ol>
</section>
<section id="create-a-mailbox-recovery-job">
<h3>Create a mailbox recovery job<a class="headerlink" href="#create-a-mailbox-recovery-job" title="Link to this heading">#</a></h3>
<p>To create a mailbox recovery job, do the following:</p>
<ol class="arabic">
<li><p>From the menu, click <strong>Restore</strong>. The restore job wizard appears.</p></li>
<li><p>At the <strong>Hosts and resources</strong> step, select the host where Exchange Server resides and select the instance. The wizard goes to the next step automatically.</p></li>
<li><p>At the <strong>Backup sets</strong> step, do the following:</p>
<p>(1) From the <strong>Restore type</strong> list, select <strong>EWS mailbox recovery</strong> or <strong>MAPI mailbox recovery</strong>.</p>
<p>(2) From the <strong>Mailbox</strong> list, select the mailboxes that you want to restore.</p>
<p>(3) From the <strong>Restore point in time</strong> list, select a point in time for the restore job.</p>
<p>(4) In the <strong>Backup sets</strong> section, the mailbox directory appears. Select the folders or records that need to be restored.</p>
<p>(5) Click <strong>Next</strong>.</p>
</li>
<li><p>At the <strong>Restore target</strong> step, select a restore target. The wizard automatically goes to the next step.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Restoring to a different host requires the same Exchange versions.</p>
</div>
<ol class="arabic simple" start="5">
<li><p>At the <strong>Restore schedule</strong> step, set the job schedule. Click <strong>Next</strong>.</p>
<ul class="simple">
<li><p>Select <strong>Immediate</strong>. ADPS will perform the job immediately after its creation.</p></li>
<li><p>Select <strong>One time</strong> and set the start time for the job.</p></li>
</ul>
</li>
<li><p>At the <strong>Restore options</strong> step, set the options according to your needs. See <a class="reference internal" href="#restore-options">Restore options</a>. Click <strong>Next</strong>.</p></li>
<li><p>At the <strong>Finish</strong> step, set the job name and confirm the job information. Click <strong>Submit</strong>.</p></li>
<li><p>After the submission, you will be redirected to the <strong>Job</strong> page. You can start, modify, and delete the job.</p></li>
</ol>
</section>
<section id="create-a-dag-point-in-time-restore-job">
<h3>Create a DAG point-in-time restore job<a class="headerlink" href="#create-a-dag-point-in-time-restore-job" title="Link to this heading">#</a></h3>
<p>The steps to create a DAG point-in-time restore job are similar to <a class="reference internal" href="#create-a-point-in-time-restore-job">Create a point-in-time restore job</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Exchange DAG point-in-time restore is performed on the node where the Exchange MBX role is installed.</p>
</div>
<section id="id2">
<h4>Before you begin<a class="headerlink" href="#id2" title="Link to this heading">#</a></h4>
<p>Before you create a DAG point-in-time restore job, do the following:</p>
<ol class="arabic simple">
<li><p>Ensure that the backed-up database does not have circular logging enabled.</p></li>
<li><p>Ensure that the database exists and has enabled the <strong>This database can be overwritten by a restore</strong> option in the properties. If the database already exists, remove it. If the database does not exist, create it first.</p></li>
<li><p>It is recommended to remove any replicated databases before a database restore is performed. Next, back up the contents in the folder where the database resides (It refers to the folder of xx.edb. You can right-click the properties of the database to find the folder) to other location, while also emptying the folder.</p></li>
</ol>
</section>
</section>
<section id="create-a-dag-mailbox-recovery-job">
<h3>Create a DAG mailbox recovery job<a class="headerlink" href="#create-a-dag-mailbox-recovery-job" title="Link to this heading">#</a></h3>
<p>The steps to create a DAG mailbox recovery job are similar to <a class="reference internal" href="#create-a-mailbox-recovery-job">Create a mailbox recovery job</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Exchange DAG mailbox recovery is performed on the node where the Exchange CAS role is installed.</p>
</div>
</section>
<section id="restore-options">
<h3>Restore options<a class="headerlink" href="#restore-options" title="Link to this heading">#</a></h3>
<p>ADPS provides the following restore options for Exchange Server:</p>
<ul class="simple">
<li><p>Common options</p></li>
</ul>
<table class="longtable table" id="id6">
<caption><span class="caption-text">Restore common options</span><a class="headerlink" href="#id6" title="Link to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Limitations</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Restore database</p></td>
<td><p>Enter the name of the database that you want to restore. The original database is restored if you leave it blank. To restore to a different target database, create the target database before creating a point-in-time restore job.</p></td>
<td><p>Available for point-in-time restore jobs.</p></td>
</tr>
<tr class="row-odd"><td><p>If the database cannot be overwritten</p></td>
<td><p>ADPS provides two options if the Exchange Server database cannot be overwritten:  <br> - Send an alert message and cancel the job  <br> - Allow overwriting the database</p></td>
<td><p>Available for point-in-time restore jobs.</p></td>
</tr>
<tr class="row-even"><td><p>Channels</p></td>
<td><p>It can improve restore efficiency. The default value is 1. The value cannot exceed the maximum channel number of backup sets.</p></td>
<td><p>Not available for MAPI backup jobs.</p></td>
</tr>
<tr class="row-odd"><td><p>Automatically mount database</p></td>
<td><p>After the point-in-time restore job is completed, the database is mounted automatically. It is enabled by default.</p></td>
<td><p>Available for point-in-time restore jobs.</p></td>
</tr>
<tr class="row-even"><td><p>Target mailbox</p></td>
<td><p>Select a target mailbox for restore. The default target is the original mailbox.</p></td>
<td><p>Available for EWS mailbox recovery jobs.</p></td>
</tr>
<tr class="row-odd"><td><p>Restore directory</p></td>
<td><p>Select a directory for restore. The default target is the original directory.</p></td>
<td><p>Available for EWS and MAPI mailbox recovery jobs.</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>Advanced options:</p></li>
</ul>
<table class="longtable table" id="id7">
<caption><span class="caption-text">Restore advanced options</span><a class="headerlink" href="#id7" title="Link to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Limitations</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Reconnection time</p></td>
<td><p>The value ranges from 1 to 60 minutes. The job continues after the abnormal reset occurs in the network within the set time.</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>Resumption buffer size</p></td>
<td><p>Specifies the resumption buffer size. The default value is 10 MiB. The bigger the resumption buffer size is, the more physical storage will be consumed. However, a bigger resumption buffer size can prevent data loss when the throughput of the business system is high.</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>Speed limit</p></td>
<td><p>Limits data transfer speed or disk read/write speed for different time periods. The unit can be KiB/s, MiB/s, and GiB/s.</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>Precondition</p></td>
<td><p>Checked before the job starts. The job execution will be aborted and the job state will be idle when the precondition is invalid.</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>Pre-/Post-script</p></td>
<td><p>The pre-script is executed after the job starts and before the resource is restored. The post-script is executed after the resource is restored.</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="glossary">
<h2>Glossary<a class="headerlink" href="#glossary" title="Link to this heading">#</a></h2>
<table class="longtable table" id="id8">
<caption><span class="caption-text">Glossary</span><a class="headerlink" href="#id8" title="Link to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Term</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>fast compression</p></td>
<td><p>A compression method that uses fast compression algorithms to compress data during the backup job.</p></td>
</tr>
</tbody>
</table>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../obs/obs.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">User Guide for Object Storage</p>
      </div>
    </a>
    <a class="right-next"
       href="../linux_os/linux_os.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">User Guide for Linux OS</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#planning-and-preparation">Planning and preparation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#install-and-configure-the-agent">Install and configure the agent</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-the-compatibility">Verify the compatibility</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#install-the-agent">Install the agent</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#activate-licenses-and-authorize-users">Activate licenses and authorize users</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#backup">Backup</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#backup-types">Backup types</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#backup-policies">Backup policies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exchange-versions-for-backup-types">Exchange versions for backup types</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exchange-server-backup-and-restore-account">Exchange Server backup and restore account</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#before-you-begin">Before you begin</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#log-in-to-the-resource">Log in to the resource</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-database-backup-job">Create a database backup job</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-mailbox-backup-job">Create a mailbox backup job</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-dag-backup-job">Create a DAG backup job</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-dag-mailbox-backup-job">Create a DAG mailbox backup job</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#backup-options">Backup options</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#restore">Restore</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#restore-types">Restore types</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Before you begin</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-point-in-time-restore-job">Create a point-in-time restore job</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-mailbox-recovery-job">Create a mailbox recovery job</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-dag-point-in-time-restore-job">Create a DAG point-in-time restore job</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Before you begin</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-dag-mailbox-recovery-job">Create a DAG mailbox recovery job</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#restore-options">Restore options</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#glossary">Glossary</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Aurreum
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  Copyright © 2022-2024 Aurreum
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>